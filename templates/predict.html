<!doctype html>
<html>
<head>
    <title>Stock Prediction</title>
     <!-- Add link to static css later if needed -->
    <!-- <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"> -->
</head>
<body>
    <h1>Stock Prediction</h1>
    <form method="post">
        <label for="tickers">Enter stock tickers (comma-separated):</label><br>
        <input type="text" id="tickers" name="tickers" value="{{ tickers if tickers is not none else '' }}" size="50"><br><br>
        <input type="submit" value="Get Predictions">
    </form>

    {% if predictions %}
        <h2>Prediction Results (Ranked)</h2>
        {% if predictions.items() %}
            <table>
                <thead>
                    <tr>
                        <th>Ticker</th>
                        <th>Predicted Price Change</th>
                        <th>Source Model</th> {# Add column header for source model #}
                    </tr>
                </thead>
                <tbody>
                    {% for ticker, data in predictions.items() %}
                    <tr>
                        <td>{{ ticker }}</td>
                        <td>{{ "%.6f" | format(data['Predicted_Price_Change']) if data['Predicted_Price_Change'] is not none else 'N/A' }}</td> {# Format prediction and handle NaN #}
                        <td>{{ data['Source'] }}</td> {# Display the source model #}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            {# Display Plots #}
            <h2>Prediction Plots</h2>
            {% for ticker, plot_url in plot_urls.items() %}
                {% if plot_url %}
                    <h3>{{ ticker }} Plot</h3>
                    <img src="{{ plot_url }}" alt="Stock Price Prediction Plot for {{ ticker }}" style="max-width: 100%; height: auto;">
                {% else %}
                    <p>Plot not available for {{ ticker }}.</p>
                {% endif %}
            {% endfor %}

        {% else %}
            <p>No valid predictions were made for the entered tickers.</p>
        {% endif %}
    {% endif %}

    <p><a href="{{ url_for('home') }}">Go Home</a></p>
</body>
</html>
